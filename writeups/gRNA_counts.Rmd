---
title: "gRNA counts across datasets"
author: "Tim"
date: '2022-06-13'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

```

## R Markdown



```{r}
data_dir <- paste0(.get_config_path("LOCAL_SCEPTRE2_DATA_DIR"), "data/")
papers <- list.files(data_dir)
```

Loop over the data; (consider grouped and ungrouped versions.)

```{r}
for (paper in papers) {
  paper_dir <- paste0(data_dir, paper, "/")
  datasets <- list.files(paper_dir)
  for (dataset in datasets) {
    gRNA_odm <- lowmoi::load_dataset_modality(data_fp = paste0(paper, "/", dataset, "/grna_assignment"))
    gRNA_mat <- gRNA_odm |> lowmoi::load_whole_odm()
    gRNA_assignments <- apply(X = gRNA_mat, MARGIN = 2, FUN = function(col) names(which.max(col)))
    
    ggplot(data = data.frame(assignment = gRNA_assignments), mapping = aes(x = assignment)) +
      geom_bar()
    
  }
}
```
