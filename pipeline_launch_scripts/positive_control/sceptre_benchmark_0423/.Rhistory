ggplot2::geom_col(col = "black") +
facet_null(dataset ~ .) +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
xlab("")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_grid(dataset ~ .) +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
xlab("")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_null(dataset ~ .) +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
xlab("")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_null(dataset ~ .) +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
xlab("")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_null(dataset ~ .)
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method))
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_null(dataset ~ .)
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black")
head(n_reject_df)
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ .) +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
xlab("")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom") +
xlab("")
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
reject_threshes
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
n_reject_df <- pc_res |>
na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh),
reject_thresh = reject_thresh)
make_barplot <- function(n_reject_df, reject_thresh) {
n_reject_df |>
dplyr::filter(reject_thresh == 0.001) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
}
make_barplot(n_reject_df, 1e-3)
make_barplot(n_reject_df, 1e-4)
make_barplot(n_reject_df, 1e-5)
make_barplot(n_reject_df, 1e-6)
load_all()
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
n_reject_df <- pc_res |>
na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh),
reject_thresh = reject_thresh)
make_barplot <- function(n_reject_df, reject_thresh) {
n_reject_df |>
dplyr::filter(reject_thresh == reject_thresh) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
}
make_barplot(n_reject_df, 1e-3)
make_barplot(n_reject_df, 1e-4)
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
n_reject_df <- pc_res |>
na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh),
reject_thresh = reject_thresh)
make_barplot <- function(n_reject_df, reject_thresh) {
n_reject_df |>
dplyr::filter(reject_thresh == !!reject_thresh) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
}
make_barplot(n_reject_df, 1e-4)
n_reject_df |>
dplyr::filter(reject_thresh == !!reject_thresh)
reject_thresh <- 1e-3
n_reject_df |>
dplyr::filter(reject_thresh == !!reject_thresh)
n_reject_df |>
dplyr::filter(reject_thresh == !!reject_thresh) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
reject_thresh <- reject_threshes[3]
n_reject_df |>
dplyr::filter(reject_thresh == !!reject_thresh) |>
arrange(method) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
reject_thresh
n_reject_df |>
dplyr::filter(reject_thresh == !!reject_thresh)
reject_thresh
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
n_reject_df <- pc_res |>
na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_threshes),
reject_thresh = reject_thresh)
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
n_reject_df <- pc_res |>
na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_threshes),
reject_thresh = reject_threshes)
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
n_reject_df <- pc_res |>
na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_threshes),
reject_thresh = reject_threshes)
reject_thresh
pc_res |> na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh)) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
reject_thresh <- 1e-7
pc_res |> na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh)) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
make_barplot(pc_res, reject_threshes[1])
pc_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
reject_threshes <- c(1e-3, 1e-4, 1e-5, 1e-6, 1e-7)
make_barplot <- function(pc_res, reject_thresh) {
pc_res |> na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh)) |>
ggplot2::ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
ggplot2::geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
}
make_barplot(pc_res, reject_threshes[1])
make_barplot(pc_res, reject_threshes[2])
make_barplot(pc_res, reject_threshes[3])
make_barplot(pc_res, reject_threshes[4])
make_barplot(pc_res, 1e-3)
make_barplot(pc_res, 1e-3)
pc_res |> na.omit() |>
group_by(dataset, method) |>
summarize(n_pc_reject = sum(p_value < reject_thresh)) |>
ggplot(ggplot2::aes(x = method,
y = n_pc_reject,
fill = method)) +
geom_col(col = "black") +
facet_wrap(dataset ~ ., scales = "free_y") +
ylab("N discoveries") +
xlab("method") +
theme(legend.title = element_blank(),
legend.position = "bottom",
axis.text.x = element_blank())
result_dir
undercover_res <- readRDS(paste0(result_dir, "positive_control_analysis/sceptre_benchmark_0423.rds"))
head(undercover_res)
undercover_res |> dplyr::filter(method == "sceptre_approximate_poisson")
undercover_res |> head()
result_dir
head(undercover_res)
undercover_res <- readRDS(paste0(result_dir, "undercover_grna_analysis/sceptre_benchmark_0423.rds"))
head(undercover_res)
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "frangieh/co_culture/gene")
head(undercover_res_sub)
head(undercover_res_sub)
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method)
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9)
undercover_res <- readRDS(paste0(result_dir, "undercover_grna_analysis/sceptre_benchmark_0423.rds")) |> na.omit()
undercover_res <- readRDS(paste0(result_dir, "undercover_grna_analysis/sceptre_benchmark_0423.rds")) |> na.omit()
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method)
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band()
nrow(undercover_res_sub)
head(undercover_res_sub)
tail(undercover_res_sub)
undercover_res <- readRDS(paste0(result_dir, "undercover_grna_analysis/sceptre_benchmark_0423.rds")) |> na.omit()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "frangieh/co_culture/gene")
head(undercover_res_sub)
tail(undercover_res_sub)
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9, col = method) +
stat_qq_band() +
ggplot2::scale_x_reverse() +
ggplot2::scale_y_reverse() +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
ggplot2::ggtitle("Q-Q plot (untransformed)")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9)
head(undercover_res_sub)
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value),
col = method) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9)
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_reverse() +
ggplot2::scale_y_reverse() +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
ggplot2::ggtitle("Q-Q plot (untransformed)")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme_bw()
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
head(undercover_res)
undercover_res$dataset |> unique()
undercover_res <- readRDS(paste0(result_dir, "undercover_grna_analysis/sceptre_benchmark_0423.rds")) |> na.omit()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "frangieh/ifn_gamma/gene")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "frangieh/control/gene")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
head(undercover_res)
undercover_res$dataset |> unique()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "simulated/experiment_1/gene")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
undercover_res$dataset |> unique()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "schraivogel/enhancer_screen_chr11/gene")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
undercover_res$dataset |> unique()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "schraivogel/enhancer_screen_chr8/gene")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
undercover_res$dataset |> unique()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "papalexi/eccite_screen/gene ")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "papalexi/eccite_screen/gene")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
undercover_res$dataset |> unique()
undercover_res <- readRDS(paste0(result_dir, "undercover_grna_analysis/sceptre_benchmark_0423.rds")) |> na.omit()
undercover_res_sub <- undercover_res |> dplyr::filter(dataset == "papalexi/eccite_screen/protein")
ggplot2::ggplot(data = undercover_res_sub,
mapping = ggplot2::aes(y = p_value, col = method)) +
stat_qq_points(ymin = 1e-8, size = 0.55, alpha = 0.9) +
stat_qq_band() +
ggplot2::scale_x_continuous(trans = revlog_trans(10)) +
ggplot2::scale_y_continuous(trans = revlog_trans(10)) +
ggplot2::labs(x = "Expected null p-value", y = "Observed p-value") +
ggplot2::geom_abline(col = "black") +
theme(legend.position = "bottom") +
theme_bw()
