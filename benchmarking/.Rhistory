calibration_result <- paste0(.get_config_path("LOCAL_SCEPTRE2_DATA_DIR"),
"undercover_gRNA_check_results.rds") |> readRDS()
code_dir <- paste0(.get_config_path("LOCAL_CODE_DIR"), "sceptre2-manuscript/")
library(utilities)
library(ggplot2)
library(cowplot)
# first, seurat method
seurat_p <- calibration_result |> dplyr::filter(method == "seurat_de") |>
ggplot(mapping = aes(y = p_value)) +
stat_qq_points(size = 0.7, ymin = 1e-10) +
stat_qq_band() +
geom_abline() +
scale_x_continuous(trans = revlog_trans(base = 10)) +
scale_y_continuous(trans = revlog_trans(base = 10)) +
facet_wrap(~dataset, scales = "free") +
labs(x = "Expected quantile", y = "Observed quantile") +
theme_bw() +
ggtitle("Seurat DE method")
devtools::install_github("Katsevich-Lab/katlabutils")
