p_sn
p_emp/p_kde
p_emp/p_sn
z_star <- 4
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
bw <- bw.SJ(x = z_null_samp, nb = 5000)
z_star <- 4
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
i <- 4
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
z_null_samp <- sample(z_null, replace = FALSE, size = 10000)
bw <- bw.SJ(x = z_null_samp, nb = 5000)
z_star <- 4
z_star
p_kde <- f(z_star, z_null_samp, bw)
p_kde
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_emp
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_sn
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
i <- 3
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
z_null_samp <- sample(z_null, replace = FALSE, size = 10000)
bw <- bw.SJ(x = z_null_samp, nb = 5000)
z_star <- 4
n_samp <- 50000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
z_null_samp
bw <- bw.SJ(x = z_null_samp)
z_star <- 4
p_kde <- f(z_star, z_null_samp, bw)
p_kde
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_emp
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_sn
p_kde <- f(z_star, z_null_samp, bw)
p_kde
p_kde
p_emp
i <- 7
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
bw
p_kde <- f(z_star, z_null_samp, bw)
p_kde
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_emp
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_sn
i <- 8
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_kde
p_kde
p_emp
p_sn
p_sn
i <- 9
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
i <- 9
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
i <- 9
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name =x <- sceptre_debug |>
filter(dataset == "frangieh/co_culture/gene") |>
sample_n(8) |>
select(response_id, undercover_grna, p_value, ks_stat, p_value_emp)
"frangieh/co_culture/gene", output_amount = 3, B = 100000)
x <- sceptre_debug |>
filter(dataset == "frangieh/co_culture/gene") |>
sample_n(8) |>
select(response_id, undercover_grna, p_value, ks_stat, p_value_emp)
f <- function(x, z_null, bw) {
l_p <- mean(pnorm(x, z_null, bw))
2 * min(l_p, 1 - l_p)
}
i <- 1
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
i
p_kde
p_emp
p_sn
i <- 2
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_kde
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_emp
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_sn
p_emp/p_kde
p_emp/p_sn
i <- 3
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
i
i <- 4
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
i
i <- 5
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
i
i <- 6
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
i
i <- 7
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
i
i <- 8
sceptre_debug$dataset |> unique()
x <- sceptre_debug |>
filter(dataset == "papalexi/eccite_screen/gene") |>
sample_n(8) |>
select(response_id, undercover_grna, p_value, ks_stat, p_value_emp)
f <- function(x, z_null, bw) {
l_p <- mean(pnorm(x, z_null, bw))
2 * min(l_p, 1 - l_p)
}
i <- 1
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
x <- sceptre_debug |>
filter(dataset == "papalexi/eccite_screen/gene") |>
sample_n(8) |>
select(response_id, undercover_grna, p_value, ks_stat, p_value_emp)
f <- function(x, z_null, bw) {
l_p <- mean(pnorm(x, z_null, bw))
2 * min(l_p, 1 - l_p)
}
i <- 1
x
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "frangieh/co_culture/gene", output_amount = 3, B = 100000)
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "papalexi/eccite_screen/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
i
i <- i } 1
i <-2
i <- 1
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "papalexi/eccite_screen/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
i
i <- 3
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "papalexi/eccite_screen/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
i
i <- 4
response_id <- x[i, "response_id"] |> as.character()
undercover_grna <- x[i, "undercover_grna"] |> as.character()
sceptre_args <- lowmoi:::get_sceptre_function_args_for_pair(
response_id = response_id, undercover_grna = undercover_grna,
dataset_name = "papalexi/eccite_screen/gene", output_amount = 3, B = 100000)
out <- do.call(what = sceptre2::run_sceptre_low_moi, args = sceptre_args)
z_null <- out |>
select(starts_with("z_null_")) |>
as.numeric()
z_star <- out$z_value
hist(z_null, breaks = 50)
abline(v = z_star, col = "blue")
n_samp <- 10000
z_null_samp <- sample(z_null, replace = FALSE, size = n_samp)
bw <- bw.SJ(x = z_null_samp)
p_kde <- f(z_star, z_null_samp, bw)
p_emp <- sceptre2:::compute_empirical_p_value(z_star, z_null, "both")
p_sn <- sceptre2:::compute_skew_normal_p_value(dp = sceptre2:::fit_skew_normal(z_null_samp)$dp,
z_star = z_star, side = "both")
p_kde
p_emp
p_sn
p_emp/p_kde
p_emp/p_sn
p_emp
p_kde
p_sn
p_emp/p_kde
p_emp/p_sn
