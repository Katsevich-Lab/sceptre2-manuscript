library(tidyverse)
source(paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/shared_figure_script.R"))
sceptre2_dir <- .get_config_path("LOCAL_SCEPTRE2_DATA_DIR")
# load the dataset sparsity results; determine mean sparsity level of gene modality, protein modality, and TAP-seq
frac_n_nonzero_df <- readRDS(paste0(sceptre2_dir, "/results/dataset_sample_sizes/frac_entries_zero.rds"))
gene_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "co_culture", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "control", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "ifn_gamma", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "papalexi", dataset == "eccite_screen", modality == "gene") |> pull(prop_zero)) |> mean()
gene_modality_sparsity
gene_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "co_culture", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "control", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "ifn_gamma", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "papalexi", dataset == "eccite_screen", modality == "gene") |> pull(prop_zero))
gene_modality_sparsity
gene_modality_sparsity |> round(2)
gene_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "co_culture", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "control", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "frangieh", dataset == "ifn_gamma", modality == "gene") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "papalexi", dataset == "eccite_screen", modality == "gene") |> pull(prop_zero)) |> mean()
gene_modality_sparsity
tap_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr11") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr8") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "ground_truth_tapseq") |> pull(prop_zero)) |>
mean()
c(frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr11") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr8") |> pull(prop_zero))
tap_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr11") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr8") |> pull(prop_zero)) |>
mean()
tap_modality_sparsity
tap_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr11") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr8") |> pull(prop_zero)) |>
mean()
c(frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr11") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr8") |> pull(prop_zero))
tap_modality_sparsity <-
c(frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr11") |> pull(prop_zero),
frac_n_nonzero_df |> dplyr::filter(paper == "schraivogel", dataset == "enhancer_screen_chr8") |> pull(prop_zero)) |>
mean()
tap_modality_sparsity
