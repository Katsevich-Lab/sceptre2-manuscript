ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin() +
geom_boxplot(outlier.shape = NA, coef = 0) +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_boxplot(outlier.shape = NA, coef = 0) +
geom_violin() +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin() +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "green") +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin() +
geom_boxplot(outlier.shape = NA, coef = 0, fill = NA) +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(col = "darkred") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = NA, col = "darkblue") +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin() +
geom_boxplot(outlier.shape = NA, coef = 0) +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "darkred") +
geom_boxplot(outlier.shape = NA, coef = 0) +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "darkred") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = NA) +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "darkred") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = NA, col = "darkred") +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "darkred") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey", col = "darkred") +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey", col = "darkred") +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
theme_bw() +
scale_y_continuous(limits = c(0, 50), expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
prop_table
class(prop_table)
as.data.frame(prop_table)
prop_table <- cont_table |> prop.table(margin = 1)
prop_table
prop_table <- cont_table |>
prop.table(margin = 1) |>
as.data.frame()
prop_table
prop_table <- cont_table |>
prop.table(margin = 1) |>
as.data.frame() |>
filter(grna_binary_vect == 1)
prop_table
prop_table
prop_table <- cont_table |>
prop.table(margin = 1) |>
as.data.frame() |>
filter(grna_binary_vect == 1) |>
select(-grna_binary_vect, freq = Freq)
prop_table
prop_table <- cont_table |>
prop.table(margin = 1) |>
as.data.frame() |>
filter(grna_binary_vect == 1) |>
select(-grna_binary_vect, freq = Freq) |>
mutate(bio_rep = fct_recode(bio_rep, "Rep 1" = "rep_1", "Rep 2" = "rep_2", "Rep 3" = "rep_3"))
cont_table |>
prop.table(margin = 1) |>
as.data.frame() |>
filter(grna_binary_vect == 1) |>
select(-grna_binary_vect, freq = Freq)
prop_table <- cont_table |>
prop.table(margin = 1) |>
as.data.frame() |>
filter(grna_binary_vect == 1) |>
select(-grna_binary_vect, freq = Freq, bio_rep = biorep_vect_nt) |>
mutate(bio_rep = fct_recode(bio_rep, "Rep 1" = "rep_1", "Rep 2" = "rep_2", "Rep 3" = "rep_3"))
prop_table
prop_table
head(prop_table)
ggplot(data = prop_table, aes(x = bio_rep, y = freq))
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity")
p_d2
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Fraction of cells with perturbation")
p_d2
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Fraction cells with perturbation")
p_d2
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Frac cells with perturbation")
p_d2
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate")
p_d2
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme
p_d2
p_d2 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0)))
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0)))
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d1
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0)))
p_d1
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d2
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0)))
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d1
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA))
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_D1
p_d1
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0.01)))
p_d1
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme
p_d1
p_d2
p_d <- cowplot::plot_grid(p_d1, p_d2)
p_D
p_d
############
# CREATE FIG
############
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
p_d
p_d
p_d
title <- ggdraw() +
draw_label(
"Concounding on Papalexi data",
x = 0,
hjust = 0) +
theme(
plot.margin = margin(0, 0, 0, 7)
)
plot_grid(title, p_d, ncol = 1, rel_heights = c(0.1, 1))
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0.01))) +
ggtitle("Confounding on ")
p_d1
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0.01))) +
ggtitle("Confounding on") +
opts(plot.title = theme_text(hjust=1))
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0.01))) +
ggtitle("Confounding on") +
theme(plot.title = element_text(hjust=1))
p_d1
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
ggtitle("Papalexi data") +
theme(plot.title = element_text(hjust=1))
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0.01))) +
ggtitle("Confounding on") +
theme(plot.title = element_text(hjust=1))
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
ggtitle("Papalexi data") +
my_theme +
theme(plot.title = element_text(hjust=1))
p_d <- cowplot::plot_grid(p_d1, p_d2)
p_d
p_d <- gridExtra::grid.arrange(p_d1, p_d2)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1)
p_d1 <- ggplot(data = prop_table,
aes(x = bio_rep, y = freq)) +
geom_bar(stat = "identity", fill = "lightgray", col = "black") +
ylab("Frac. cells with perturbation") +
xlab("Biological replicate") +
my_theme +
scale_y_continuous(limits = c(0, NA),
expand = expansion(mult = c(0.01, 0.01))) +
theme(plot.title = element_text(hjust=1))
p_d2 <- ggplot(data = rel_expression_df,
aes(x = bio_rep, y = rel_expression)) +
geom_violin(fill = "lightgrey", col = "black") +
geom_boxplot(outlier.shape = NA, coef = 0, fill = "lightgrey") +
scale_y_continuous(limits = c(0, 50),
expand = expansion(mult = c(0.01, 0))) +
ylab("Relative gene expression") +
xlab("Biological replicate") +
my_theme +
theme(plot.title = element_text(hjust=1))
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top=textGrob("Papalexi confounding"))
p_d
plot(p_d)
textGrob
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = textGrob("Papalexi confounding"))
p_d
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = textGrob("Papalexi confounding"))
p_d
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = "Papalexi confounding")
p_d
############
# CREATE FIG
############
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
fig
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = "Confounding on Papalexi data")
############
# CREATE FIG
############
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = "Confounding (Papalexi gene modality)")
############
# CREATE FIG
############
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = textGrob("Confounding (Papalexi gene modality)", gp=gpar(fontsize=10)))
p_d
gridExtra::text_grob
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = grid::textGrob("Confounding (Papalexi gene modality)", gp=gpar(fontsize=10)))
p_d
plot(p_d)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = grid::textGrob("Confounding (Papalexi gene modality)", gp=gpar(fontsize=10)))
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = grid::textGrob("Confounding (Papalexi gene modality)", gp = gpar(fontsize=9)))
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = grid::textGrob("Confounding (Papalexi gene modality)", gp = gpar(fontsize=9)))
############
# CREATE FIG
############
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = grid::textGrob("Confounding (Papalexi gene modality)", gp = gpar(fontsize=6)))
############
# CREATE FIG
############
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
text_grob
install.packages("ggpubr")
ggpubr::text_grob
ggpubr::text_grob
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = ggpubr::text_grob("Confounding (Papalexi gene modality)", gp = gpar(fontsize=6)))
p_d
plot(p_d)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = ggpubr::text_grob("Confounding (Papalexi gene modality)", size = 8))
plot(p_d)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = ggpubr::text_grob("Confounding (Papalexi gene modality)", size = 12))
plot(p_d)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = ggpubr::text_grob("Confounding (Papalexi gene modality)", size = 11))
plot(p_d)
p_d <- gridExtra::grid.arrange(p_d1, p_d2, nrow = 1, top = ggpubr::text_grob("Confounding (Papalexi gene modality)", size = 10))
plot(p_d)
fig <- cowplot::plot_grid(p_a, NULL,
p_c, p_d,
NULL, NULL, ncol = 2, labels = "auto", align = "h", axis = "l")
to_save_fp <- paste0(.get_config_path("LOCAL_CODE_DIR"),
"sceptre2-manuscript/R_scripts/figure_creation/fig_2/r_output.png")
ggsave(filename = to_save_fp, plot = fig, device = "png",
scale = 1.1, width = 6.5, height = 7, dpi = 330)
