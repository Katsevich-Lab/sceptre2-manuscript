library(ondisc)
library(sceptre2)
papalexi_dir <- paste0(.get_config_path("LOCAL_SCEPTRE2_DATA_DIR"), "data/papalexi/eccite_screen/")
library(ondisc)
library(sceptre2)
LOCAL_SCEPTRE2_DATA_DIR="/Users/kmason/data/projects/sceptre2/"
papalexi_dir <- paste0(LOCAL_SCEPTRE2_DATA_DIR, "data/papalexi/eccite_screen/")
# gene info
gene_odm_fp <- paste0(papalexi_dir, "gene/matrix.odm")
# grna info
grna_odm_fp <- paste0(papalexi_dir, "grna_assignment/matrix.odm")
# protein info
protein_odm_fp <- paste0(papalexi_dir, "protein/matrix.odm")
# mm odm metadata fp
mm_metadata_fp <- paste0(papalexi_dir, "multimodal_metadata.rds")
# construct mm odm
mm_odm <- read_multimodal_odm(odm_fps = c(gene_odm_fp, grna_odm_fp, protein_odm_fp),
multimodal_metadata_fp = mm_metadata_fp)
library(sceptre)
mm_odm <- read_multimodal_odm(odm_fps = c(gene_odm_fp, grna_odm_fp, protein_odm_fp),
multimodal_metadata_fp = mm_metadata_fp)
library(ondisc)
library(sceptre2)
library(sceptre)
library(lowmoi)
sessionInfo()
devtools::install_github('timothy-barry/ondisc')
library(ondisc)
devtools::install_github('timothy-barry/ondisc')
LOCAL_SCEPTRE2_DATA_DIR="/Users/kmason/data/projects/sceptre2/"
papalexi_dir <- paste0(LOCAL_SCEPTRE2_DATA_DIR, "data/papalexi/eccite_screen/")
# gene info
gene_odm_fp <- paste0(papalexi_dir, "gene/matrix.odm")
# grna info
grna_odm_fp <- paste0(papalexi_dir, "grna_assignment/matrix.odm")
# protein info
protein_odm_fp <- paste0(papalexi_dir, "protein/matrix.odm")
# mm odm metadata fp
mm_metadata_fp <- paste0(papalexi_dir, "multimodal_metadata.rds")
# construct mm odm
mm_odm <- read_multimodal_odm(odm_fps = c(gene_odm_fp, grna_odm_fp, protein_odm_fp),
multimodal_metadata_fp = mm_metadata_fp)
sessionInfo()
# construct mm odm
mm_odm <- read_multimodal_odm(odm_fps = c(gene_odm_fp, grna_odm_fp, protein_odm_fp),
multimodal_metadata_fp = mm_metadata_fp)
library(ondisc)
# construct mm odm
mm_odm <- read_multimodal_odm(odm_fps = c(gene_odm_fp, grna_odm_fp, protein_odm_fp),
multimodal_metadata_fp = mm_metadata_fp)
sessionInfo()
library(ondisc)
library(sceptre2)
library(sceptre)
#devtools::install_github('timothy-barry/ondisc')
LOCAL_SCEPTRE2_DATA_DIR="/Users/kmason/data/projects/sceptre2/"
papalexi_dir <- paste0(LOCAL_SCEPTRE2_DATA_DIR, "data/papalexi/eccite_screen/")
# gene info
gene_odm_fp <- paste0(papalexi_dir, "gene/matrix.odm")
# grna info
grna_odm_fp <- paste0(papalexi_dir, "grna_assignment/matrix.odm")
# protein info
protein_odm_fp <- paste0(papalexi_dir, "protein/matrix.odm")
# mm odm metadata fp
mm_metadata_fp <- paste0(papalexi_dir, "multimodal_metadata.rds")
# construct mm odm
mm_odm <- read_multimodal_odm(odm_fps = c(gene_odm_fp, grna_odm_fp, protein_odm_fp),
multimodal_metadata_fp = mm_metadata_fp)
knitr::opts_chunk$set(echo = TRUE)
# Load packages.
library(Seurat)
library(SeuratData)
library(ggplot2)
library(patchwork)
library(scales)
library(dplyr)
library(reshape2)
library(mixtools)
library(stringr)
# Download dataset using SeuratData.
InstallData(ds = "thp1.eccite")
A = readRDS('gene_result.rds')
B = readRDS('protein_result.rds')
View(A)
View(B)
P = B[,1]
P = unlist(P)
P = abs(P)
P = as.numeric(P)
P = p.adjust(P,method = 'BH')
BP= cbind(P,B[,c(2,3)])
BP = BP[which(BP[,3] == 'PDL1')]
View(BP)
