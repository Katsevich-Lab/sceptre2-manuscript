pathways_sceptre_pval[,2] = signif(as.numeric(pathways_sceptre_pval[,2]),
digits=2)
#make table
results = kable(pathways_sceptre_pval,booktabs = TRUE, linesep = "",
caption = "SCEPTRE Pathway Enrichment Analysis With Top 300 Genes by Pvalue")
kable_styling(results,position = "center", latex_options = "scale_down")
#run pathway enrichment again
pathways_seurat = pathways_seurat_pval
pathway_name = "TYROBP causal network in microglia WP3945"
sceptre_ty_genes = pathways$WikiPathway_2021_Human$Genes[
pathways$WikiPathway_2021_Human$Term == pathway_name ]
seurat_ty_genes = pathways_seurat$WikiPathway_2021_Human$Genes[
pathways_seurat$WikiPathway_2021_Human$Term == pathway_name ]
View(pathways_seurat_pval)
pathways_seurat_pval[4,3]
pathways_seurat_log[4,3]
View(pathways_seurat_log)
pathways_seurat_log[10,3]
#get top 300 genes by log fold change
top = 300
CUL3_top = rownames(CUL3_marker)[order(CUL3_marker$avg_log2FC,decreasing = T
)[1:top]]
#run pathway enrichment analysis
pathways = enrichr(CUL3_top,databases = 'WikiPathway_2021_Human')
#get term and pvalue (using subset truncates pvalues for some reason)
pathways_seurat_log = cbind(pathways$WikiPathway_2021_Human$Term,
pathways$WikiPathway_2021_Human$Adjusted.P.value,
pathways$WikiPathway_2021_Human$Genes)[1:50,]
pathways_seurat_log[,2] = signif(as.numeric(pathways_seurat_log[,2]), digits=2)
#make table
results = kable(pathways_seurat_log,booktabs = TRUE, linesep = "",
caption = "Seurat Pathway Enrichment Analysis With Top 300 Genes by Log Fold
Change")
kable_styling(results,position = "center", latex_options = "scale_down")
View(pathways$WikiPathway_2021_Human)
pathways_seurat_log[10,3]
View(pathways_seurat_log)
pathway_name = "TYROBP causal network in microglia WP3945"
sceptre_ty_genes = pathways$WikiPathway_2021_Human$Genes[
pathways$WikiPathway_2021_Human$Term == pathway_name ]
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
#run pathway enrichment again
pathways_seurat = pathways_seurat_pval
pathways = enrichr(SCEPTRE_pval,databases = 'WikiPathway_2021_Human')
#get term and pvalue (using subset truncates pvalues for some reason)
pathways_sceptre_pval = cbind(pathways$WikiPathway_2021_Human$Term,
pathways$WikiPathway_2021_Human$Adjusted.P.value,
pathways$WikiPathway_2021_Human$Genes)[1:50,]
pathways_sceptre_pval[,2] = signif(as.numeric(pathways_sceptre_pval[,2]),
digits=2)
#make table
results = kable(pathways_sceptre_pval,booktabs = TRUE, linesep = "",
caption = "SCEPTRE Pathway Enrichment Analysis With Top 300 Genes by Pvalue")
kable_styling(results,position = "center", latex_options = "scale_down")
#run pathway enrichment again
pathways_seurat = pathways_seurat_pval
pathway_name = "TYROBP causal network in microglia WP3945"
sceptre_ty_genes = pathways$WikiPathway_2021_Human$Genes[
pathways$WikiPathway_2021_Human$Term == pathway_name ]
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
sceptre_ty_genes
seurat_ty_genes
View(CUL3_SCEPTRE)
View(CUL3_SCEPTRE)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
View(sceptre_results)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
sceptre_results = CUL3_SCEPTRE[CUL3_SCEPTRE$response_id%in%seurat_ty_genes]
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
sceptre_results = CUL3_SCEPTRE[CUL3_SCEPTRE$response_id%in%seurat_ty_genes,]
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
sceptre_results = CUL3_SCEPTRE[unfactor(CUL3_SCEPTRE$response_id)%in%seurat_ty_genes,]
unfactor(CUL3_SCEPTRE$response_id)%in%seurat_ty_genes
seurat_ty_genes
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = strsplit(seurat_ty_genes,";")
#sceptre_results = CUL3_SCEPTRE[unfactor(CUL3_SCEPTRE$response_id)%in%seurat_ty_genes,]
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = as.vector(strsplit(seurat_ty_genes,";"))
#sceptre_results = CUL3_SCEPTRE[unfactor(CUL3_SCEPTRE$response_id)%in%seurat_ty_genes,]
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
#sceptre_results = CUL3_SCEPTRE[unfactor(CUL3_SCEPTRE$response_id)%in%seurat_ty_genes,]
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
sceptre_results = subset(CUL3_SCEPTRE,response.id %in% seurat_ty_genes)
View(CUL3_SCEPTRE)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
View(sceptre_results)
View(CUL3_SCEPTRE)
View(CUL3_SCEPTRE)
View(sceptre_results)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
sum(SCEPTRE_pval%in%seurat_ty_genes)
View(sceptre_results)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
sceptre_results$top_300 = sceptre_results$response_id%in%SCEPTRE_pval
View(sceptre_results)
pathway_name = "TYROBP causal network in microglia WP3945"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
sceptre_results = subset(sceptre_results,select = c(response_id,p_value,
log_fold_change))
sceptre_results$top_300 = sceptre_results$response_id%in%SCEPTRE_pval
View(sceptre_results)
View(pathways_sceptre_log)
View(pathways_seurat)
#pathway_name = "TYROBP causal network in microglia WP3945"
pathway_name = "NRF2 pathway WP2884"
seurat_ty_genes = pathways_seurat[pathways_seurat[,1]== pathway_name,3]
seurat_ty_genes = unlist(strsplit(seurat_ty_genes,";"))
sceptre_results = subset(CUL3_SCEPTRE,response_id %in% seurat_ty_genes)
sceptre_results = subset(sceptre_results,select = c(response_id,p_value,
log_fold_change))
sceptre_results$top_300 = sceptre_results$response_id%in%SCEPTRE_pval
View(sceptre_results)
seurat_pval = rownames(CUL3_marker)[order(CUL3_marker$p_val,decreasing = F)
[1:top]]
seurat_fold = rownames(CUL3_marker)[order(CUL3_marker$avg_log2FC,decreasing = T
)[1:top]]
sum(seurat_pval%in%SCEPTRE_pval)
sum(seurat_pval%in%SCEPTRE_fold)
sum(seurat_pval%in%SCEPTRE_pval)
sum(seurat_pval%in%SCEPTRE_fold)
sum(seurat_fold%in%SCEPTRE_pval)
sum(seurat_fold%in%SCEPTRE_fold)
#see overlao with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by pvalue is',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by log fold change is',overlap_fold))
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by pvalue is',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by log fold change is',overlap_fold))
#see overlao with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by pvalue is ',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by log fold change is ',overlap_fold))
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by pvalue is ',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by log fold change is ',overlap_fold))
#see overlao with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by pvalue and the top 300 SCEPTRE genes by pvalue is ',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by log fold change is ',overlap_fold))
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by pvalue is ',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by log fold change is ',overlap_fold))
#see overlao with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by pvalue is ',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by pvalue and the
top 300 SCEPTRE genes by log fold change is ',overlap_fold))
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by pvalue is ',overlap_pval))
print(paste0('The overlap between the top 300 seurat genes by log fold change
and the top 300 SCEPTRE genes by log fold change is ',overlap_fold))
View(CUL3_SCEPTRE)
#see overlao with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_pval))
#see overlao with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
View(CUL3_marker)
#get top 300 genes by pvalue
pval_pos = CUL3_SCEPTRE$p_value
#apply BH
pval_pos = p.adjust(pval_pos,method = 'BH')
#get which are significant
sig_genes = which(CUL3_SCEPTRE$log_fold_change > 0 & pval_pos < 0.05)
sig_genes = CUL3_SCEPTRE$response_id[sig_genes]
#get top 300 genes by pvalue
pval_pos = CUL3_SCEPTRE$p_value
#apply BH
pval_pos = p.adjust(pval_pos,method = 'BH')
#get which are significant
sig_genes = which(CUL3_SCEPTRE$log_fold_change > 0 & pval_pos < 0.05)
sig_genes = unfactor(CUL3_SCEPTRE$response_id[sig_genes])
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%sig_genes)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
print(paste0(string_A,string_B,overlap_pval))
View(CUL3_SCEPTRE)
sort(CUL3_SCEPTRE$p_value)[300]
#get top 300 genes by pvalue
pval_pos = CUL3_SCEPTRE$p_value
#apply BH
pval_pos = p.adjust(pval_pos,method = 'BH')
#get which are significant
sig_genes = which(CUL3_SCEPTRE$log_fold_change > 0 & pval_pos < 0.05)
sig_genes = unfactor(CUL3_SCEPTRE$response_id[sig_genes])
pathways = enrichr(sig_genes,databases = 'WikiPathway_2021_Human')
#get term and pvalue (using subset truncates pvalues for some reason)
pathways_sceptre_pval = cbind(pathways$WikiPathway_2021_Human$Term,
pathways$WikiPathway_2021_Human$Adjusted.P.value,
pathways$WikiPathway_2021_Human$Genes)[1:50,]
pathways_sceptre_pval[,2] = signif(as.numeric(pathways_sceptre_pval[,2]),
digits=2)
#make table
results = kable(pathways_sceptre_pval,booktabs = TRUE, linesep = "",
caption = "SCEPTRE Pathway Enrichment Analysis With All Significant Genes")
kable_styling(results,position = "center", latex_options = "scale_down")
View(pathways$WikiPathway_2021_Human)
View(CUL3_SCEPTRE)
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1,"top 300 seurat genes by pvalue is ",overlap_fold))
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_fold))
seurat_fold
seurat_pval
mean(seurat_fold%in% suerat_pval)
mean(seurat_fold%in% seurat_pval)
length(seurat_fold)
length(seurat_pval)
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_seurat))
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_seurat))
string_D = "The overlap between the top 300 SCEPTRE genes by pvalue and by log"
string_E = " fold change is "
overlap_sceptre = sum(SCEPTRE_fold%in%SCEPTRE_pval)
print(paste0(string_D,string_E,overlap_seurat))
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_seurat))
string_D = "The overlap between the top 300 SCEPTRE genes by pvalue and by log"
string_E = " fold change is "
overlap_sceptre = sum(SCEPTRE_fold%in%SCEPTRE_pval)
print(paste0(string_D,string_E,overlap_sceptre))
knitr::opts_chunk$set(echo = TRUE)
print('hello \n my name is cars)
print("hello \n my name is cars")
print("hello \\n my name is cars")
cat("hello \n my name is cars")
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_seurat))
string_D = "The overlap between the top 300 SCEPTRE genes by pvalue and by log"
string_E = " fold change is "
overlap_sceptre = sum(SCEPTRE_fold%in%SCEPTRE_pval)
cat(paste0(string_D,"\n",string_E,overlap_sceptre))
#see overlap with sceptre
overlap_pval = sum(seurat_pval%in%SCEPTRE_pval)
overlap_fold = sum(seurat_pval%in%SCEPTRE_fold)
string_A = "The overlap between the top 300 seurat genes by pvalue and the"
string_B = "top 300 SCEPTRE genes by pvalue is "
string_C = "top 300 SCEPTRE genes by log fold change is "
print(paste0(string_A,string_B,overlap_pval))
print(paste0(string_A,string_C,overlap_pval))
string_1 = "The overlap between the top 300 seurat genes by log fold change and"
string_2 = " the top 300 SCEPTRE genes by pvalue is "
string_3 = " the top 300 SCEPTRE genes by log fold change is "
overlap_pval = sum(seurat_fold%in%SCEPTRE_pval)
overlap_fold = sum(seurat_fold%in%SCEPTRE_fold)
print(paste0(string_1,string_2,overlap_pval))
print(paste0(string_1,string_3,overlap_fold))
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_seurat))
string_D = "The overlap between the top 300 SCEPTRE genes by pvalue and by log"
string_E = " fold change is "
overlap_sceptre = sum(SCEPTRE_fold%in%SCEPTRE_pval)
cat(paste0(string_D,string_E,overlap_sceptre))
overlap_mat = matrix(NA,2,2)
colnames(overlap_mat) = c('SCEPTRE_Pval','SCEPTRE_LFC')
colnames(overlap_mat) = c('seurat_Pval','seurat_LFC')
#see overlap with sceptre
overlap_mat[1,1] = sum(seurat_pval%in%SCEPTRE_pval)
overlap_mat[1,2] = sum(seurat_pval%in%SCEPTRE_fold)
overlap_mat[2,1] = sum(seurat_fold%in%SCEPTRE_pval)
overlap_mat[2,2]= sum(seurat_fold%in%SCEPTRE_fold)
overlap_seurat = sum(seurat_fold%in%seurat_pval)
print(paste0(string_1," the top 300 seurat genes by pvalue is ",overlap_seurat))
string_D = "The overlap between the top 300 SCEPTRE genes by pvalue and by log"
string_E = " fold change is "
overlap_sceptre = sum(SCEPTRE_fold%in%SCEPTRE_pval)
cat(paste0(string_D,string_E,overlap_sceptre))
overlap_mat = matrix(NA,2,2)
colnames(overlap_mat) = c('SCEPTRE_Pval','SCEPTRE_LFC')
colnames(overlap_mat) = c('seurat_Pval','seurat_LFC')
#see seurat by pvalue overlap with sceptre
overlap_mat[1,1] = sum(seurat_pval%in%SCEPTRE_pval)
overlap_mat[1,2] = sum(seurat_pval%in%SCEPTRE_fold)
#get seurat by LFC overlap woth sceptre
overlap_mat[2,1] = sum(seurat_fold%in%SCEPTRE_pval)
overlap_mat[2,2]= sum(seurat_fold%in%SCEPTRE_fold)
#get within method overlap
overlap_within = matrix(NA,1,2)
colnames(overlap_within) = c('seurat','SCEPTRE')
rownames(overlap_within) = c('Within Method Overlap')
overlap_within[,1] = sum(seurat_fold%in%seurat_pval)
overlap_within[,2] = sum(SCEPTRE_fold%in%SCEPTRE_pval)
#make table
results = kable(overlap_mat,booktabs = TRUE, linesep = "",
caption = "Seurat and SCEPTRE Top 300 Genes Overlap")
kable_styling(results,position = "center", latex_options = "scale_down")
#make table
results = kable(overlap_within,booktabs = TRUE, linesep = "",
caption = "Seurat and SCEPTRE Top 300 Genes Overlap Within Each Method")
kable_styling(results,position = "center", latex_options = "scale_down")
#make table
results = kable(overlap_within,booktabs = TRUE, linesep = "",
caption = "Seurat and SCEPTRE Top 300 Genes Overlap Within Each Method")
kable_styling(results,position = "center", latex_options = "scale_down")
overlap_mat = matrix(NA,2,2)
colnames(overlap_mat) = c('Sceptre By Pvalue','Sceptre By log fold change')
colnames(overlap_mat) = c('Seurat By Pvalue','Seurat By log fold change')
#see seurat by pvalue overlap with sceptre
overlap_mat[1,1] = sum(seurat_pval%in%SCEPTRE_pval)
overlap_mat[1,2] = sum(seurat_pval%in%SCEPTRE_fold)
#get seurat by LFC overlap woth sceptre
overlap_mat[2,1] = sum(seurat_fold%in%SCEPTRE_pval)
overlap_mat[2,2]= sum(seurat_fold%in%SCEPTRE_fold)
#get within method overlap
overlap_within = matrix(NA,1,2)
colnames(overlap_within) = c('seurat','SCEPTRE')
rownames(overlap_within) = c('Within Method Overlap')
overlap_within[,1] = sum(seurat_fold%in%seurat_pval)
overlap_within[,2] = sum(SCEPTRE_fold%in%SCEPTRE_pval)
#make table
results = kable(overlap_mat,booktabs = TRUE, linesep = "",
caption = "Seurat and SCEPTRE Top 300 Genes Overlap (Out of 300)")
kable_styling(results,position = "center", latex_options = "scale_down")
View(pathways$WikiPathway_2021_Human)
#get top 300 genes by log fold change
top = 300
CUL3_top = rownames(CUL3_marker)[order(CUL3_marker$avg_log2FC,decreasing = T
)[1:top]]
#run pathway enrichment analysis
pathways = enrichr(CUL3_top,databases = 'WikiPathway_2021_Human')
#get term and pvalue (using subset truncates pvalues for some reason)
pathways_seurat_log = cbind(pathways$WikiPathway_2021_Human$Term,
pathways$WikiPathway_2021_Human$Adjusted.P.value,
pathways$WikiPathway_2021_Human$Overlap)[1:50,]
pathways_seurat_log[,2] = signif(as.numeric(pathways_seurat_log[,2]), digits=2)
#make table
results = kable(pathways_seurat_log,booktabs = TRUE, linesep = "",
caption = "Seurat Pathway Enrichment Analysis With Top 300 Genes by Log Fold
Change")
kable_styling(results,position = "center", latex_options = "scale_down")
#get top 300 genes by log fold change
top = 300
CUL3_top = rownames(CUL3_marker)[order(CUL3_marker$avg_log2FC,decreasing = T
)[1:top]]
#run pathway enrichment analysis
pathways = enrichr(CUL3_top,databases = 'WikiPathway_2021_Human')
#get term and pvalue (using subset truncates pvalues for some reason)
pathways_seurat_log = cbind(pathways$WikiPathway_2021_Human$Term,
pathways$WikiPathway_2021_Human$Adjusted.P.value)[1:50,]
colnames(pathways_seurat_log) = c('Term','Adj.Pvalue')
pathways_seurat_log[,2] = signif(as.numeric(pathways_seurat_log[,2]), digits=2)
#make table
results = kable(pathways_seurat_log,booktabs = TRUE, linesep = "",
caption = "Seurat Pathway Enrichment Analysis With Top 300 Genes by Log Fold
Change")
kable_styling(results,position = "center", latex_options = "scale_down")
View(pathways_sceptre_log)
